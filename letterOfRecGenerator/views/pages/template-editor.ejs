<!DOCTYPE html>
<html>
<head>
    <title><%= title %></title>
    <link rel="stylesheet" href="/stylesheets/style.css"/>
    <link rel="stylesheet" href="/css/template-editor.css"/>
    <link rel="stylesheet" type="text/css" href="/css/all.css"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script type="text/javascript" src="/javascripts/template-editor.js" id="<%= id %>"
            letterheadImgData="<%= letterheadImage %>" footerImgData="<%= footerImage %>" saveSwitchData="<%= saveSwitch %>"></script>
    <script src="//rubaxa.github.io/Sortable/Sortable.js"></script>

</head>
<body>
<div class = "templates">
    <header>
        <% include ../partials/header %>
    </header>
    <p class="title"><%= title %></p>
    <div id="template-editor-container">
        <h2 class="section-header">Template Name</h2>
        <div class="error-container">
            <div id="name-container">
                <input id="name-container-text-field" type="text" class="text-field" placeholder="Enter a template name here..."
                       value="<%= templateName %>"/>
            </div>
        </div>

        <h2 id="upload-letterhead" class="section-header">Upload Letterhead</h2>
        <div class="upload-preview-container">
            <% if(locals.letterheadImage){ %>
            <img id="letterhead-preview" src="<%= letterheadImage %>" alt=""/>
            <% } else{ %>
            <img id="letterhead-preview" src="#" alt=""/>
            <% } %>
            <form id="letterhead-upload">
                <input type="file" name="file" id="letterhead-upload-file"/>
                <input type="submit" name="Submit"/>
            </form>
        </div>

        <h2 id="upload-footer" class="section-header">Upload Footer</h2>
        <div class="upload-preview-container">
            <% if(locals.footerImage){ %>
            <img id="footer-preview" src="<%= footerImage %>" alt=""/>
            <% } else{ %>
            <img id="footer-preview" src="#" alt=""/>
            <% } %>
            <form id="footer-upload">
                <input type="file" name="file" id="footer-upload-file"/>
                <input type="submit" name="Submit"/>
            </form>
        </div>

        <h2 id="custom-questions" class="section-header">Custom Questions</h2>

        <div id="questions-container"></div>

        <button class="large-circle-button" onclick="addQuestion()">+</button>

        <h2 id="letter-boilerplate" class="section-header">Letter Boilerplate</h2>
        <div id="tag-container">
            <h4 class="inline-block"> Tags: </h4>
            <% for (var q=0; q < questions.length; q++) { %>
                <button class="popup"  name="tag_buttons" value ="<%= questions[q].tag %>"><%= questions[q].tag %>
                    <span class="popup-text">
                        <%= questions[q].question %>
                    </span>
                </button>
            <% } %>
        </div> 
        <div class="error-container">
            <div id="letter-container">
                <div id="letter-text-area" contentEditable="true" id="text" onfocus="deemphasizeTags()"
                     onblur="emphasizeTags()"></div>
                <h3>&lt!TAG_NAME&gt in the letter will be replaced by the corresponding question's answer</h3>
                <h3>Tags can be nested in the replacement text of other questions.</h3>
            </div>
        </div>

        <br/><br/>
        <%  if (typeof saveSwitch == "boolean") { 
            if(saveSwitch){%>
            <div class="flex-row">
                <button id="save-button" onclick="saveTemplate()">Save</button>
            </div>
        <% }} else if (typeof saveSwitch == "string") { 
                if (saveSwitch == "true"){%>
            <div class="flex-row">
                <button id="save-button" onclick="saveTemplate()">Save</button>
            </div>
        <% }} %>
    </div>

</div>
</body>

<div id="add-question-modal">
    <div class="content">
        <div class="flex-row">
            <h1>Select Question Type</h1>
        </div>
        <div class="flex-row option-cont">
            <button onclick="addTextAnswerQuestion()">Text Answer</button>
        </div>
        <div class="line"></div>
        <div class="flex-row option-cont">
            <button onclick="addRadioButtonQuestion()">Radio Button</button>
        </div>
        <div class="line"></div>
        <div class="flex-row option-cont">
            <button onclick="addCheckboxQuestion()">Checkbox</button>
        </div>
        <!--<div class="line"></div>-->
        <!--<div class="flex-row option-cont">-->
            <!--<button onclick="addCustomQuestion()">Custom</button>-->
        <!--</div>-->
    </div>
</div>

<div id="warning-modal">
    <div class="content">
        <div class="flex-row">
            <h1>Are you sure?</h1>
        </div>
        <div class="flex-row">
            <button onclick="executeWarningModalFunction()">Yes</button>
            <button onclick="hideWarningModal()">No</button>
        </div>
    </div>
</div>
</html>

<script>
    $("button[name='tag_buttons']").on("click", function(e) {
        var val = $(this).val();
        var theDiv = document.getElementById("letter-text-area");
        var content = document.createTextNode(" "+ val);
        theDiv.appendChild(content);
    }); 
</script>


<script>
	$(window).click(function(e) {

	});
</script>

