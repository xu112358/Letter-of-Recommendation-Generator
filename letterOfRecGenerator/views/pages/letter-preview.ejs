<!DOCTYPE html>
<html>
    <head>
        <title><%= title %></title>
        <link rel="stylesheet" href="/stylesheets/style.css"/>
        <link rel="stylesheet" type="text/css" href="/css/letter-preview.css"/>
        <link rel="stylesheet" type="text/css" href="/css/modal.css"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/trix/0.11.1/trix.css">
        <link rel="stylesheet" type="text/css" href="/css/all.css"/>
        <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
        <script type="text/javascript" src="/javascripts/letter-preview.js" id="'<%= id %>'"></script>
        <script type="text/javascript" src="/javascripts/html2pdf.bundle.min.js" id="'<%= id %>'"></script>
        <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/trix/0.11.1/trix.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.13/semantic.min.js"></script>
    </head>
    <body onload="onLoad()">


    <div class="background">
        <header>
            <% include ../partials/header %>
        </header> 
        <p id="letter-preview-heading" class="title">Preview Letter </p>
        <p id="" class="letter-preview-subheading">Send an email to <%= title %></p>


        <p id="edit-heading" class="letter-preview-subheading">Click to edit </p>


        <div style="display: none;" id="formId" value="<%= id %>"><%= id %></div>
        <div style="display: none;" id="form" value="<%= form %>"><%= form %></div>


        <!-- Letter Preview Container -->
        <div id="outer-container">
            
        </div>

        <!-- upload template button -->

        <div class="flex-display upload-cont">
            <h2 id="upload-template" class="section-header">Upload Template</h2>
            <div class="upload-preview-container flex1">

                <form id="template-upload">
                    <input type="file" name="file" id="footer-upload-file"/>
                    <input type="text" name="ingroup1" id="id1" value ="" >
                    <script type="text/javascript">
                    var query = window.location.search.substring(1);
                    var vars = query.split("&");
                    for(var i=0;i<vars.length;i++){
                        var pair = vars[i].split("=");
                        if(pair[0] == "id"){
                            document.getElementById("id1").value = pair[1];
                            //return pair[1];
                        }
                    }
                    //document.getElementById("id1").value = "cok";
                    </script>
                    <script type="text/javascript">
                        function test2() {
                            var pageId = document.getElementById("id1").value;
                            console.log(pageId);
                            // $.ajax({
                            //     url: 'http://localhost:3000/letter-preview/templateUpload',
                            //     data: {
                            //         id:id,
                            //         letter: letterHTML,
                            //         date: date
                            //     },
                            //     type: 'POST',
                            //     success: function(d){
                            //         console.log("success in drive")
                            //         window.location.href = 'http://localhost:3000/recommender-dashboard';
                            //     },
                            //     error: function() {
                            //         console.log("error in drive")
                            //     }
                            // })
                        }
                    </script>
                    
                    <input id="submit" type="submit" name="Submit" onclick="downloadLetter2()"/>
                </form>
            </div>
        </div>  


        <div class="upload-preview-container flex1" id ="template-picker">
            <p id="add-heading" class="section-header">Upload Template: </p>
            <form id="template-upload" action="/letter-preview/templateUpload" method="POST" encType="multipart/form-data" onsubmit="changeFooterText()">            
                <input type="file" name="file" id="footer-upload-file"/>
            </form>
        </div>
     

        <!-- Save and Cancel Letter Preview Edit -->
        <div id="add-question-modal">
            <div id="letter-preview-modal" class="inside">

                <form class="ui form example">
                    <p class="modal-title"> Edit Letter </p>
                    <div class="ui message error"></div>

                    <div id="content" value="" type="hidden" name="content"></div>
                    <trix-editor input="content"></trix-editor>

                </form>

                <div class="flex-row">
                    <button id="save-btn" class="convert-pdf modal-btns" onclick="saveEditModal()">Save</button>
                    <button id="cancel-btn" class="convert-pdf modal-btns" onclick="cancelEditModal()">Cancel</button>
                </div>

            </div>
        </div>



        <!-- Add date to letter -->
        <div id="date-picker">
            <p id="add-heading" class="section-header">Add Date: </p>
            <input type="date" name="date" id="date">
        </div>

        <!-- Adding the save to pdf file -->
        <button class="download-button" id="downloadButton" onClick="downloadLetter()"> Download Letter</button>

        
            
    </div>
    </body>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</html>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    